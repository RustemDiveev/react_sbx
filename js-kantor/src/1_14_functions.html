<!DOCTYPE HTML>
<html>

    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="./css/common.css">
    </head>

    <body>

        <script src="./js/1_14_script.js"></script>

        <button><a href="../start_here.html">К содержанию</a></button> 
        <h1>Функции</h1>
        <p>
            Писать что такое функция и как она работает - не буду.
        </p>

        <h2>Локальные переменные</h2>
        <p>
            Функция может содержать локальные переменные, объявленные через var. 
            Такие переменные видны только внутри функции.
        </p>
<code>
function showMessage() {
    var message = "Hi, I'm Mr Meeseeks!"; //local variable 

    alert(message);
}

showMessage(); // will work 
alert(message); // ERROR!, переменная видна только внутри
</code>

        <p>
            Блоки if/else, switch, for, while, do..while не влияют на область видимых переменных!!!
        </p>
        <p>
            При объявлении переменной в таких блоках - она будет видна во всей функции.
        </p>
<code>
function count() {
    // variables won't be destroyed after loop end 
    for (var i = 0; i < 3; i++) {
        var j = i * 2;
    }

    alert(i); // i=3, последнее значение i 
    alert(j); // j=4, последнее значение j
}
</code>

        <p>
            Неважно, где именно в функции и сколько раз объявляется переменная. 
            Любое объявление срабатывает один раз и распространяется на всю функцию.
        </p>
        <p>
            Объявления переменных в примере можно передвинуть наверх, это ни на что не повлияет.
        </p>
<code>
function count() {
    var i, j;

    for (i = 0; i < 3; i++) {
        j = i * 2;
    }

    alert(i); // i=3, последнее значение i 
    alert(j); // j=4, последнее значение j
}
</code>

        <h2>Внешние переменные</h2>
        <p>
            Функция может обратиться ко внешней переменной.
            Также есть доступ не только на чтение, но и на запись.
        </p>
<code>
var userName = "Donny"; // глобальная переменная

function shutUp() {
    var message = "Shut up, " + userName;
    alert(message);
}

shutUp(); // Shut up, Donny

function shutUpBilly() {
    userName = "Billy";
    alert(userName + ", have you been time tripping?");
}

shutUpBilly(); // Billy, have you been time tripping?
alert(userName); // Billy
</code>
        <p>
            Глобальные переменные - переменные, объявленные на уровне всего скрипта.
        </p>

        <h2>Внимание, неявное объявление глобальных переменных.</h2>
        <p>
            В старом стандарте js существовала возможность неявного объявления переменных присвоением значения.
        </p>
<code>
function showMessage() {
    message = "Hello";
}

showMessage();
alert(message);
</code>
        <p>
            В коде выше message не объявлена, а в функции сразу присваивается. Возможно, забыли поставить var.
        </p>
        <p>
            При use strict такой код привел бы к ошибке. 
        </p>
        <p>
            Здесь опасность в том, что уже может быть объявлена глобальная переменная. 
            А код без явного объявления изменит её. 
        </p>
        <p>
            Этого следует избегать!
        </p>

        <h2>Параметры</h2>
        <p>
            Параметры копируются в локальные переменные функции
        </p>
<code>
function showMessage(from, text) {
    from = "**" + from + "**"; // изменяется локальная переменная from 
    alert(from + ": " + text);
}

var from = "Beavis";
showMessage(from, "Hey"); // **Beavis**: Hey
alert(from); // Beavis 
</code>

        <h2>Аргументы по умолчанию</h2>
        <p>
            Функцию можно вызвать с любым количеством аргументов.
            Если параметр не передан при вызове, то считается undefined.
        </p>
        <p>
            Пример передачи значения по умолчанию
        </p>
<code>
function showMessage(from, text) {
    if (text === undefined) {
        text = "Text is not passed";
    }
    alert(from + ": " + text);
}

showMessage("Masha", "Hello");
showMessage("Pasha");
</code>

        <p>
            При объявлении функции необязательные аргументы, как правило, располагают в конце списка.
            Для указания значения по умолчанию используются следующие приемы:
        </p>
        <ul>
            <li>
                Можно проверить, равен ли аргумент undefined, и если да, то записать значение по умолчанию.
            </li>
            <li>
                Можно использовать оператор || 
<code>
function showMessage(from, text) {
    text = text || "Text is not passed";
    ...
}
</code>
            </li>
        </ul>

        <p>
            Если аргументов передано больше, чем надо, то ошибки не будет. 
            Но чтобы получить лишние аргументы, нужно будет прочитать их из специального объекта arguments.
        </p>
        
        <h2>Возврат значения</h2>
        <p>
            Используется директива return.
        </p>
        <p>
            Может находиться в любом месте функции. 
            Как только до неё доходит управление - функция завершается и значение передается обратно. 
        </p>
        <p>
            return может использоваться и без значения, чтобы прекратить выполнение и выйти из функции.
        </p>

        <h2>Значение функции без return и с пустым return</h2>
        <p>
            В случае, когда функция не вернула значение или return был без аргументов, считается, что она вернула undefined.
        </p>
<code>
function doNothing1() {}
alert(doNothing1()); // undefined 

function doNothing2() {return;}
alert(doNothing2()); // undefined
</code>

        <h1>Задачи</h1>
        <h2>Обязателен ли else?</h2>
<code>
// 1 
function checkAge(age) {
    if (age > 18) {
        return true;
    } else {
        return confirm("Ask ur parentz!");
    }
}

// 2 
function checkAge(age) {
    if (age > 18) {
        return true;
    }

    return confirm("Ask ur parentz!");
}

// Нету отличий между поведением обоих функций, но лучше все-таки иметь один return
</code>

        <h2>Переписать функцию, используя оператор ? или ||</h2>
<code>
function checkAge(age) {
    if (age > 18) {
        return true;
    } else {
        return confirm("Ask ur parentz!");
    }
}
</code>

<code>
// Вариант с ? 
function checkAge1(age) {
    return (age > 18) ? true : confirm("Ask ur parentz!");
}

// Вариант с || 
function checkAge2(age) {
    return (age > 18) || confirm("Ask ur parentz!");
}
</code>

        <h2>Функция min(a, b)</h2> 
        <div>
            <div>
                <label for="a_input">a</label>
                <input type="text" id="A_INPUT" name="a_input">
            </div>
            <div>
                <label for="b_input">b</label>
                <input type="text" id="B_INPUT" name="b_input">
            </div>
            <div>
                <button onclick="min()">Решение</button>
                <span id="MIN_SOLUTION"></div>
            </div>
        </div>
        
        <h2>Функция pow(x, n)</h2>
        <div>
            <div>
                <label for="x_input">x</label>
                <input type="text" id="X_INPUT" name="x_input">
            </div>
            <div>
                <label for="n_input">n</label>
                <input type="text" id="N_INPUT" name="n_input">
            </div>
            <div>
                <button onclick="pow()">Решение</button>
                <span id="POW_SOLUTION"></div>
            </div>
        </div>

    </body>

</html>